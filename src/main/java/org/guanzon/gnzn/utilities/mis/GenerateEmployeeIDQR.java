package org.guanzon.gnzn.utilities.mis;

import java.awt.Color;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.security.MessageDigest;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Base64;
import java.util.Properties;
import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import org.guanzon.appdriver.base.GRider;
import static org.guanzon.gnzn.utilities.mis.CustomQR.generateQR;

public class GenerateEmployeeIDQR {
    public static void main (String [] args){
        String path;
        if(System.getProperty("os.name").toLowerCase().contains("win")){
            path = "D:/GGC_Maven_Systems";
        }
        else{
            path = "/srv/GGC_Maven_Systems";
        }
        System.setProperty("sys.default.path.config", path);
        
        try {
            Properties po_props = new Properties();
            po_props.load(new FileInputStream(path + "/config/cas.properties"));
            
            GRider instance = null;
                    
            if (po_props.getProperty("developer.mode").equals("1")){
                instance = new GRider("gRider");
        
                if (!instance.logUser("gRider", "M001000001")){
                    System.exit(1);
                }
            } else {
                System.err.println("Unable to log user.");
                System.exit(1);
            }
            
            String url = "https://www.guanzongroup.com.ph/employee?id=";
            
//            String sql = "SELECT" +
//                                "  a.sEmployID" +
//                                ", b.sCompnyNm" +
//                                ", a.sIDNumber" +
//                            " FROM Employee_Master001 a" +
//                                ", Client_Master b" +
//                            " WHERE a.sEmployID = b.sClientID" +
//                                " AND a.sEmployID IN ('C02911000043', 'M00124000709', 'M00113000402', 'M00115001151', 'M00114001028', 'M00123001762', 'M00125001434', 'M01911000061', 'M00109021069', 'M00123000376', 'M01307000336', 'M00107002056', 'M00106000333', 'M02008001069', 'M00114000793', 'M01603000117', 'M01105001182', 'M00906001658', 'M00112000427', 'M00113001060', 'M00104000932', 'M00114000255', 'M01308000147', 'M07712000165', 'M03511000680', 'M00199000408', 'M00114001278', 'M03512000710', 'M01310000757', 'M00119002647', 'M00116000394', 'M00122001541', 'M00122001106', 'M00116001157', 'C01511004077', 'M04308000392', 'M00114001493', 'M00115000805', 'M00112000874', 'M00114001229', 'M00115000065', 'M00119000173', 'M00122001196', 'M00113001332', 'M00112001985', 'M00121001095', 'M02010001079', 'M05810000086', 'M00114000632', 'M02610000660', 'M00113000965', 'M00112001966', 'M00507001910', 'C01111003207', 'M00117001278', 'M00117003153', 'M00114000387', 'M00120001779', 'M00118000309', 'M00113000196', 'M00117000411', 'M00117000700', 'M00113001613', 'M00112001698', 'M05309000007', 'M00109006239', 'M00114001426', 'M00107003187', 'M00121001037', 'M00114001563', 'M00114000391', 'M00116000669', 'M00117001333', 'M01612000282', 'M00103001003', 'M00117001481', 'M00118001870', 'M04511000121', 'M00122000142', 'M00805000157', 'M00118001622', 'M00118001012', 'M04511000123', 'M00114000514', 'M00113001600', 'M00111005506', 'M00117002796', 'M00116001292', 'M00109020429', 'M00118001579', 'M00115001667', 'C00109001324', 'M00117000786', 'M00115000607', 'M02105000096', 'M00114000678', 'M04411000124', 'M05411000386', 'M00113000589', 'M00118003157', 'M00114001071', 'M00115001707', 'M03809000658', 'M00116000533', 'M00118001439', 'M00120001024', 'M00114000759', 'C00109001231', 'M00117003300', 'M00117000187', 'M00120002070', 'M00118000306', 'M00111005581', 'M00114000660', 'M00116002318', 'M00112001024', 'M00110004041', 'M00118000053', 'M00111000071', 'M00114000019', 'M00116001750', 'M00113000905', 'M01211000072', 'M00113000326', 'M07412000388', 'M00108011539', 'M01109000110', 'M07412000387', 'M00115000996', 'M04709000274', 'M06311000470', 'M01608001419', 'M00707000515', 'M00115000170', 'M00118002693', 'M03611000385', 'M00122001321', 'M00118002486', 'M00119001523', 'M00119001796', 'M00116001560', 'M00119002657', 'M00111004992', 'M00511001084', 'M00113001341', 'M00114000764', 'M00113001638', 'M06112000071', 'M00113001189', 'M00118001399', 'M00120000233', 'M00112001724', 'M03213002045', 'M06311000472', 'M00117001742', 'M00113000670', 'M03811000379', 'M00116000777', 'M03510000353', 'M00120001391', 'M00120000571', 'M00115001706', 'M00117003389', 'M00605000151', 'M00122001075', 'M00115000845', 'M00114001182', 'M00116001617', 'M00117001424', 'M00110017104', 'M01608001418', 'M06111000557', 'M00116001444', 'M00110013824', 'C02710000599', 'M00114000719', 'M00110013877', 'M00105000801', 'M06311000471', 'M00117000775', 'M00120001526', 'M00111004476', 'M00115001531', 'M05311000055', 'M00117003293', 'M00110017103', 'M00116002279', 'M00116000110', 'C00112001020', 'M00119000712', 'M00112000863', 'M00117000347', 'M00113000832', 'M00110003600', 'M00116002521', 'M00116000259', 'M00107007057', 'M01612000320', 'M00117000357', 'M00104001810', 'M00109013312', 'M00117003302', 'M05810000085', 'M00125000653', 'M00116000061', 'C02111001175', 'M00113001566', 'M00118000084', 'M00109016276', 'M00116000966', 'M00115001699', 'M00107007020', 'M00118000408', 'M00802000245', 'M00108002802', 'M00109009088', 'M00110017105', 'M00108008183', 'M00116002591', 'M00123000110', 'M00120001580', 'M00117002291', 'M00115000080', 'M00125000222', 'M00125001114', 'M00115000726', 'M00124001211', 'M00119001583', 'M00119000652', 'M00116001104', 'M00116000891', 'M00119002529', 'M00125000104', 'M00124000625', 'M00120000323', 'M00115000623', 'M00120001322', 'M00120002020', 'M02607000044', 'M00122000532', 'M00124000130', 'M00123001651', 'M00122000628', 'M00122001181', 'M00125000192', 'M00121001425', 'M00120000201', 'M00118000539', 'M00124001275', 'M00116002058', 'M00115001803', 'M00121001727', 'M00125000780', 'M00120001856', 'M00124001279', 'M00125000636', 'M00116001992', 'M00124001594', 'M00125001398', 'M00124000296', 'M00121001577', 'M00122000139', 'M00123001702', 'M00118000646', 'M00115000139', 'M00123001131', 'M00125000701', 'M00121001220', 'M00111005056', 'M00123000052', 'M00119001608', 'M00125000830', 'M00109019170', 'M00120001635', 'M00710000922', 'M00125001251', 'M00125000481', 'M00120001586', 'M00121001637', 'M00125000357', 'M00124000878', 'M00117000663', 'M00124000803', 'M00113001411', 'M00117001898', 'M00125001033', 'M00120001713', 'M00121000072', 'M00123000390', 'M00107000912', 'M00125001261', 'M00117001601', 'M00115000565', 'M00124000825', 'M00125000777', 'M00124000735', 'M00124001271', 'M00124001585', 'M00509001782', 'M00122001147', 'M00118000351', 'M00122001496', 'M00125000188', 'M00124001228', 'M00122001400', 'M00115000785', 'M00125000635', 'M04810000613', 'M00121000021', 'M00125001414', 'M00125001305', 'M00122000302', 'M00124001139', 'M00125000454', 'M00121000417', 'M00110021212', 'M00123000221', 'M00124000910', 'M00125001263', 'M00197002951', 'M00114000241', 'M00120001759', 'M00125000417', 'M03706000034', 'M00120001519', 'M00122000780', 'M00125000479', 'M00122000871', 'M00124001273', 'M00121000957', 'M00123000570', 'M00119000428', 'M00118002135', 'M00116000571', 'M00120001504', 'M00122000388', 'M00125000720', 'M00119001151', 'M00109007865', 'M00124001343', 'M00120001895', 'M00122001139', 'M00121000344', 'M00125000362', 'M00122000252', 'M00125000769', 'M00119001150', 'M00110015768', 'M00122000583', 'M00125000366', 'M00122001493', 'M00123000082', 'M00124000235', 'M00117002636', 'M02111000633', 'M00118001948', 'M00117002289', 'M00123000342', 'M00114000791', 'M00122000683', 'M00125000463', 'M08814000558', 'M00125001331', 'M00120001556', 'M00119001584', 'M00125000612', 'M00117001404', 'M00119002465', 'M00125000275', 'M00119000429', 'M00119000573', 'M00123001698', 'M00120001593', 'M00112001382', 'M00122000502', 'M00125000582', 'M00907000186', 'M00122000306', 'M00125001342', 'M00121000466', 'M00124001209', 'M00122000973', 'M00125001406', 'M00125000800', 'M00118001878', 'M00121001269', 'M00114000339', 'M00125001350', 'M00125001276', 'M00125000533', 'M00117002602', 'M00121001094', 'M00116001156', 'M00125000627', 'M00125001206', 'M00120000234', 'M00120001536', 'M00125000721', 'M00121000964', 'M00125000225', 'M00120000320', 'M00121001168', 'M00121000265', 'M04108000065', 'M00125000534', 'M00113000906', 'M00125001486', 'M00119002561', 'M00121001726', 'M00125000774', 'M00119001357', 'M00125000719', 'M00119001525', 'M00122001099', 'M00122000866', 'M00121001528', 'M00124001725', 'M00125000469', 'M00119001461', 'M00125001060', 'M00117002606', 'M00125000368', 'M00117003206', 'M00123000210', 'M00122000977', 'M00121000773', 'M00112000242', 'M02806000040', 'M00123000469', 'M00124000321', 'M00125001334', 'M00117000559', 'M00122000138', 'M00125000165', 'M00125000292', 'M00109003229', 'M00122001264', 'M00121000568', 'M00107002197', 'M00117000751', 'M00122001499', 'M00123000657', 'M00122001696', 'M00125000473', 'M00124000983', 'M00123001110', 'M00116001641', 'M00116001583', 'M00122000587', 'M00123001103', 'M00115001627', 'M00124001420', 'M00125000293', 'M00125000261', 'M00122000256', 'M00124000210', 'M00124000831', 'M00120000146', 'M00123001379', 'M00120001583', 'M00125001351', 'M00118002593', 'M00121000799', 'C01511001346', 'M00124000307', 'M00122000223', 'M00123000786', 'M00124001193', 'M00122000071', 'M00124000622', 'M00124001723', 'M00125000646', 'M00124001477', 'M00119001592', 'M00123000949', 'M00125001496', 'M00124000691', 'M00118002797', 'M00122000244', 'M00124000629', 'M00125000996', 'M00122000158', 'M00125000372', 'M00125001183', 'M00125000641', 'M00125001019', 'M00125001279', 'M00119002062', 'M00125001307', 'M00125000831', 'M00121001100', 'M00114001495', 'M00123000966', 'M00122001320', 'M00123000466', 'M00125001240', 'M00123001734', 'M00124001111', 'M00124000498', 'M00125000441', 'M00123000988', 'M00125001407', 'M00124000874', 'M00125000640', 'M00123001043', 'M00124001426', 'M00122001809', 'M00124000606', 'M00120001626', 'M00114001541', 'M00123001102', 'M00125000647', 'M00124001424', 'M00125000938', 'M00125001494', 'M00123001381', 'M00122000720', 'M00125001376', 'M00123000730', 'M00125000771', 'M00125001162', 'M00125001230', 'M00125001356', 'M00122000766', 'M00125001280', 'M00124000903', 'M00125000524', 'M00125001278', 'M00125001409', 'M00124001601', 'M00120001424', 'M00124001758', 'M00124000982', 'M00125001405', 'M00124001251', 'M00124001218', 'M00124001647', 'M00124001649', 'M00123001766', 'M00121001271', 'M00124001803', 'M00124000514', 'M00123001707', 'M00113001623', 'M00124000224', 'M00125000532', 'M00125001244', 'M00125000455', 'M00125000421', 'M00123000698', 'M00122000135', 'M00125000228', 'M00124001414', 'M00124001415', 'M00125001191', 'M00122001749', 'M00122000945', 'M00125001199', 'M00124001514', 'M00125000282', 'M00124000403', 'M00125000611', 'M00122001271', 'M00123000269', 'M00123000291', 'M00124001270', 'M00125000301', 'M00125000342', 'M00125001340', 'M00124000329', 'M00124001586', 'M00124001780', 'M00122001218', 'M00123000761', 'M00125001411', 'M00125001173', 'M00124001097', 'M00122000137', 'M00125000619', 'M00125001318', 'M00124001800', 'M00122001204', 'M00114000812', 'M00118000979', 'M00118001272', 'M00120000599', 'M00114001506', 'M00118001438', 'M00119001685', 'M00121000395', 'M00120001226', 'M00122001332', 'M00120000319', 'M00122000130', 'M00122000514', 'M00123001091', 'M00119001688', 'M00118002400', 'M00114000115', 'M00121001652', 'M00118000445', 'M00121000709', 'M01109000112', 'M00122001964', 'M00117003249', 'M00123000724', 'M00121001036', 'M00122001322', 'M03009000876', 'M00122001703', 'M00122000625', 'M00119001823', 'M00119002292', 'M00117000864', 'M00115001726', 'M00118001210', 'M00118002218', 'M00125000465', 'M00122000508', 'M00125000623', 'M00120001323', 'M00125001275', 'M00125000102', 'M00125001127', 'M00124000306', 'M00115000435', 'M00125001194', 'M00119000945', 'M00119002366', 'M00125000963', 'M00123000561', 'M00119002056', 'M00124000875', 'M00125001236', 'M00125001035', 'M00121000426', 'M00118000442', 'M00114000837', 'M00125000621', 'M00118000645', 'M00125000373', 'M00115000755', 'M00125001428', 'M00124001226', 'M00125001246', 'M00115000202', 'M00125001041', 'M00124001804', 'M00122001072', 'M00123000397', 'M00123000200', 'M00125001416', 'M00125000842', 'M00123000661', 'M00125001492', 'M00124001131', 'M00122001440', 'M00122001740', 'M00125000467', 'M00124001720', 'M00120000468', 'M00119002341', 'M00124001276', 'M00122000156', 'M00125001182', 'M00118000056', 'M00121000884', 'M00125000478', 'M00123001132', 'M00114000098', 'M00123001401', 'M00125000426', 'M04810000342', 'M00123001745', 'M00124000061', 'M00124001361', 'M00112000553', 'M00124001602', 'M00106000964', 'M00125000186', 'M00121001272', 'M00811000496', 'M00112001984', 'M00116001867', 'M00123000699', 'M00125000078', 'M00113000327', 'M00114001445', 'M00118000360', 'M00123000883', 'M00119002750', 'M00117002615', 'M00125000925', 'M00125001131', 'M00123001768', 'M00122000986', 'M00125000584', 'M00120001515', 'M00117000868', 'M00125000643', 'M00124000301', 'M00125001207', 'M00124001644', 'M00125000376', 'M00117001033', 'M00124001717', 'M00125001277', 'M00124000996', 'M00123000085', 'M00122000501', 'M00124000995', 'M00122001107', 'M00121000916', 'M00124001605', 'M00125001203', 'M00120001934', 'M00119001797', 'M00124000137', 'M00114000607', 'M00110006046', 'M00125000952', 'M00125000171', 'M00125001392', 'M00124000963', 'M00125000941', 'M00123000726', 'M00109017622', 'M00124001230', 'M02504000043', 'M00125000055', 'M00122001202', 'M00125001253', 'M00125000210', 'M00125001255', 'M00118001580', 'M00122001109', 'M00124000295', 'M00122000079', 'M00114000218', 'M00125000262', 'M00122000308', 'M00124000827', 'M00122001771', 'M00124000620', 'M00123000209', 'M00125000860', 'M00123000042', 'M00123001126', 'M00122000065', 'M00123000793', 'M00125001160', 'M00112001276', 'M00122001443', 'M00124001358', 'M00125000727', 'M00123000632', 'M00122000631', 'M00121000397', 'M00122001743', 'M03611000218', 'M00119001027', 'M00124001333', 'M00110020035', 'M00118002066', 'M00120000505', 'M00124000713', 'M00123000929', 'M00122000624', 'M00124001098', 'M00122001272', 'M00125001412', 'M00125000776', 'M00125000726', 'M00124001538', 'M00125001341', 'M00123001414', 'M00118001251', 'M00113001340', 'M00125000428', 'M00125001111', 'M00121001753', 'M00119000498', 'M00120002005', 'M00124000879', 'M00124001528', 'M00125001054', 'M00124000117', 'M00123000791', 'M00116001080', 'M00124001459', 'M00119002456', 'M00125001132', 'M00119002674', 'M00123001512', 'M00125000464', 'M00124001718', 'M00119001789', 'M00123000369', 'M00125001349', 'M00125001210', 'M00123000278', 'M00116002558', 'M00125000277', 'M05309000006', 'M00122001709', 'M00122001301', 'M00510001374', 'M00122001702', 'M00123001251', 'M00122000313', 'M00121001359', 'M03507000083', 'M00124000815', 'M00118001110', 'M00125001061', 'M00124000949', 'M00123001761', 'M00125000096', 'M00125001314', 'M00120000463', 'N00419000007', 'M00122000689', 'M00123000473', 'M00125000371', 'M00120000297', 'M00125000815', 'M00122000607', 'M00119001507', 'M00125001020', 'M00125001378', 'M00125000227', 'M00125001237', 'M00125000695', 'M00125001119', 'M00125001005', 'M00125000728', 'M00124001598', 'M00125001130', 'M00124000053', 'M00122000382', 'M00120001552', 'M00124001871', 'M00118000229', 'M00122000861', 'M00116000846', 'M00125001245', 'M00121000571', 'M00121000885', 'M02808000319', 'M00111005695', 'M00112001649', 'M01606001405', 'M00106001669', 'M00111006193', 'C02010002316', 'M00113001138', 'M00114000105', 'M00111006162', 'M00116002228', 'C00209002662', 'C03112000975', 'M00112001648', 'M00113000102', 'M00118001761', 'M00114000153', 'M00114000343', 'M00113000397', 'M00117000073', 'M00116000698', 'M00118000542', 'M00117003105', 'M00119002570', 'M00121000118', 'M00119001676', 'M00118003153', 'M00117002455', 'M00113000673', 'M00116001866', 'C01111002359', 'C01909001087', 'M00121000119', 'M00118001535', 'M00116001115', 'M00113000911', 'C03213001778', 'M00118000535', 'C00910000826', 'M00118002401', 'M00118001100', 'C00811001092', 'M00115000738', 'M00112001757', 'C02010001558', 'C00609002104', 'M00114000116', 'M00116001694', 'M00111006256', 'M00112001222', 'C01211000624', 'M00116000701', 'M00116001722', 'M00115000697', 'M00508001273', 'M00116000106', 'M00121001224', 'M00115000725', 'M00120000076', 'M00119001028', 'M00124000688', 'M00125001186', 'M00118001826', 'M00119001672', 'M00125000586', 'M00122000245', 'M00125001415', 'M00125000858', 'M00122001894', 'M00121000191', 'M00125001157', 'M00123000829', 'M00122000719', 'M00122001543', 'M00122001900', 'M00117002616', 'M00120000313', 'M00119002587', 'M00119001678', 'M00116002559', 'M00124000298', 'M00125000348', 'M00124000143', 'M00121000266', 'M00119001619', 'M00124001149', 'M00120000332', 'M00125001022', 'M00115002326', 'M00119002191', 'M00122001983', 'M00118001096', 'M00124000596', 'M00123000513', 'M00112000324', 'M00121001489', 'M00118001729', 'M00122001219', 'M00119001707', 'M00115000712', 'M00118001939', 'M00124000228', 'M00125001174', 'M00120000074', 'M00117001008', 'M00123001361', 'M00122001918', 'M00121001363', 'M00125000585', 'M00119002467', 'M00114001512', 'M00117003113', 'M00117001608', 'M00122000850', 'M00123001385', 'M00124001220', 'M00122000606', 'M00120001404', 'M00122001494', 'M00124000833', 'M00125000276', 'M00122001524', 'M00115002091', 'M00119001515', 'M00122001560', 'M00124000564', 'M00123001729', 'M00121001647', 'M00124001595', 'M00123000491', 'M00122001078', 'M00124001653', 'M00124000824', 'M00120001236', 'M00117001672', 'M00124000100', 'M00116000412', 'M00122000760', 'M00114001631', 'M00116001216', 'M00122001684', 'M00123001348', 'M00119002455', 'M00119001508', 'M00124000952', 'M00123000385', 'M00112000552')" +
//                                " AND a.sIDNumber IS NOT NULL" + 
//                            " ORDER BY a.sIDNumber";
            
            String sql = "SELECT" +
                    "  'N00124000132' sEmployID" +
                    ", 'DATARIO, MICHAEL CAMILO GONZALES' sCompnyNm" +
                    ", '01-000-00055' sIDNumber";
            
            ResultSet rs = instance.executeQuery(sql);
            
            while (rs.next()){
                String no = rs.getString("sIDNumber");
                String id = rs.getString("sEmployID");
                String name = rs.getString("sCompnyNm");
                String fname = no + " - " + name + " - " + id + ".png"; 
                
                System.out.println(url + encryptBase64(id, "empid"));
                
                generateQR(
                    url + encryptBase64(id, "empid"),
                    System.getProperty("sys.default.path.config") + "/images/logo 2.png",
                    System.getProperty("sys.default.path.config") + "/temp/idqr/" + fname + ".png",
                    600,
                    Color.WHITE,
                    Color.BLACK,
                    0, 40f,
                    40f,
                    0.20f,
                    Color.WHITE,
                    Color.BLACK, 3f,
                    0.10f, 0.25f,
                    null,                   // no label
                    "SansSerif", 30f, false, Color.WHITE,
                    40f, 10f                // ✅ label marginTop, lineSpacing
                );
                
//                generateQR(
//                    url + encryptBase64(id, "empid"),
//                    System.getProperty("sys.default.path.config") + "/images/logo 2.png",
//                    System.getProperty("sys.default.path.config") + "/temp/idqr/" + fname + ".png",
//                    600,
//                    Color.WHITE,
//                    Color.BLACK,
//                    8f, 40f,
//                    40f,
//                    0.20f,
//                    Color.WHITE,
//                    Color.BLACK, 3f,
//                    0.10f, 0.25f,
//                    null,                   // no label
//                    "SansSerif", 30f, false, Color.WHITE,
//                    40f, 10f                // ✅ label marginTop, lineSpacing
//                );
            }
        } catch (IOException | SQLException e){
            e.printStackTrace();
            System.exit(1);
        } catch (Exception ex) {
            ex.printStackTrace();
            System.exit(1);
        }
    }
    
    private static byte[] sha256Bytes(String key) throws Exception {
        MessageDigest md = MessageDigest.getInstance("SHA-256");
        return md.digest(key.getBytes(StandardCharsets.UTF_8)); // 32 bytes
    }

    private static String encryptBase64(String plaintext, String key) throws Exception {
        byte[] aesKey = sha256Bytes(key);
        SecretKeySpec keySpec = new SecretKeySpec(aesKey, "AES");

        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        cipher.init(Cipher.ENCRYPT_MODE, keySpec);

        byte[] encrypted = cipher.doFinal(plaintext.getBytes(StandardCharsets.UTF_8));
        return Base64.getEncoder().encodeToString(encrypted);
    }

    private static String decryptBase64(String base64Cipher, String key) throws Exception {
        byte[] aesKey = sha256Bytes(key);
        SecretKeySpec keySpec = new SecretKeySpec(aesKey, "AES");

        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        cipher.init(Cipher.DECRYPT_MODE, keySpec);

        byte[] decoded = Base64.getDecoder().decode(base64Cipher);
        byte[] decrypted = cipher.doFinal(decoded);
        return new String(decrypted, StandardCharsets.UTF_8);
    }
}
